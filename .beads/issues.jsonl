{"id":"leta-2ab","title":"Notify LSP when files are deleted","description":"## Problem\nLSP servers cache file contents and don't know when files are deleted. This causes stale references to be returned.\n\n## Solution\nWhen leta detects a file has been deleted (e.g., during format_locations), send textDocument/didClose notification to the LSP server to invalidate its cache.\n\nAlternatively, implement workspace/didDeleteFiles notification if the LSP supports it.\n\n## Related\nThis is a proper fix alongside leta-kay which is a workaround.","notes":"Starting implementation: detect deleted files from open_documents cache","status":"open","priority":2,"issue_type":"feature","owner":"ajansson@cloudflare.com","created_at":"2026-01-25T05:53:07.488972+01:00","created_by":"Andreas Jansson","updated_at":"2026-01-25T05:57:24.976045+01:00","labels":["enhancement"],"dependencies":[{"issue_id":"leta-2ab","depends_on_id":"leta-kay","type":"discovered-from","created_at":"2026-01-25T05:53:07.489901+01:00","created_by":"Andreas Jansson"}]}
{"id":"leta-kay","title":"Filter deleted files from refs results","description":"## Problem\nleta refs returns references from files that no longer exist.\n\n## Root cause\nformat_locations in mod.rs:184-213 checks file_path.exists() but only to skip reading context lines - the location is still included in results.\n\n## Fix\nAdd a filter to skip locations where the file doesn't exist.\n\n## Test\ntest/corpus/leta/cache_invalidation/refs_after_delete.txt","notes":"Starting work on filtering deleted files","status":"closed","priority":2,"issue_type":"bug","owner":"ajansson@cloudflare.com","created_at":"2026-01-25T05:52:59.871074+01:00","created_by":"Andreas Jansson","updated_at":"2026-01-25T05:54:20.870665+01:00","closed_at":"2026-01-25T05:54:20.870665+01:00","close_reason":"Fixed by filtering deleted files in format_locations. Test passes.","labels":["fix"]}
